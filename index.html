<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Créateur de lien NFC</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f4f4f4; }
    .container { background: white; max-width: 400px; margin: auto; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px #ccc; }
    input, button { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    #linkOutput { margin-top: 20px; }
  </style>
</head>

  <label for="contactSelect">Sélectionner un contact :</label>
<select id="contactSelect">
  <option value="">-- Choisir un contact --</option>
</select>

<input type="text" id="contactId" placeholder="ID du contact" readonly />

<script>
  async function chargerContacts() {
    try {
      const response = await fetch('contacts/index.json'); // Ce fichier contiendra la liste des fichiers contacts
      const contacts = await response.json();

      const select = document.getElementById('contactSelect');
      contacts.forEach(contact => {
        const option = document.createElement('option');
        option.value = contact.id;
        option.textContent = `${contact.prenom} ${contact.nom}`;
        select.appendChild(option);
      });

      select.addEventListener('change', (e) => {
        document.getElementById('contactId').value = e.target.value;
      });

    } catch (e) {
      console.error("Erreur chargement contacts:", e);
    }
  }

  chargerContacts();
</script>
<body>
  <div class="container">
    <h2>Créer un lien NFC</h2>
    <label for="contactId">ID du contact :</label>
    <input type="text" id="contactId" placeholder="Exemple : id0002" />
    <button onclick="generateLink()">Créer le lien</button>
    <div id="linkOutput"></div>
  </div>

  <script>
    function generateLink() {
      const id = document.getElementById('contactId').value.trim();
      if (!id) {
        alert("Merci de saisir un ID");
        return;
      }

      // Chemin vers la page d'affichage de la carte
      const baseURL = `${window.location.origin}${window.location.pathname.replace('index.html', '')}`;
      const link = `${baseURL}contact.html?id=${encodeURIComponent(id)}`;

      document.getElementById('linkOutput').innerHTML = `
        <p>Lien généré :</p>
        <input type="text" value="${link}" readonly>
        <button onclick="navigator.clipboard.writeText('${link}')">Copier le lien</button>
      `;
    }
  </script>
</body>
</html>
